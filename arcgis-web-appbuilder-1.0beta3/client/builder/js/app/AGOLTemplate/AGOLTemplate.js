//>>built
require({cache:{"url:builder/AGOLTemplate/templates/AGOLTemplate.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"front-div" data-dojo-attach-point\x3d"frontDiv"\x3e\r\n    \x3cdiv class\x3d"header-div" data-dojo-attach-point\x3d"headerDiv"\x3e\r\n      \x3cspan\x3e${nls.title}\x3c/span\x3e\r\n      \x3cimg src\x3d"builder/css/images/cancel.png" alt\x3d"img" data-dojo-attach-event\x3d"onclick:_onCancelClick"\x3e\x3c/img\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"content-part" data-dojo-attach-point\x3d"contentPart"\x3e\r\n      \x3cdiv class\x3d"tree-part" data-dojo-attach-point\x3d"treePart"\x3e\r\n        \x3cdiv class\x3d"left-part-title" style\x3d"margin-left:18px; margin-top:10px; color: #596679; font-size: 15px;"\x3e${nls.appNameTitle}${app.name}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"right-part" data-dojo-attach-point\x3d"leftPart"\x3e\r\n        \x3cdiv class\x3d"right-part-head" \x3e\r\n          \x3cspan data-dojo-attach-point\x3d"rightPartHeadText"\x3e${nls.rightPartHead}\x3c/span\x3e\r\n          \x3cdiv class\x3d"review-json-div" data-dojo-attach-point\x3d"reviewJsonDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonDivClick"\x3e${nls.viewJsonCode}\x3c/div\x3e\r\n          \x3cdiv class\x3d"review-json-back-div" style\x3d"display: none" data-dojo-attach-point\x3d"reviewJsonBackDiv" data-dojo-attach-event\x3d"onclick:_onReviewJsonBackDivClick"\x3e${nls.viewJsonBack}\x3c/div\x3e\r\n\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"right-part-subhead"\x3e\r\n          ${nls.rightPartSubhead}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"category-part" data-dojo-attach-point\x3d"categoryPart"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"show-json-div" data-dojo-attach-point\x3d"showJsonDiv"\x3e\r\n          \x3cdiv class\x3d"show-json-content-div" data-dojo-attach-point\x3d"showJsonContentDiv"\x3e     \r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"operation-div" data-dojo-attach-point\x3d"operationDiv"\x3e\r\n      \x3cdiv class\x3d"operation-item-div  download-div jimu-btn jimu-state-disabled" style\x3d"padding: 0px;" data-dojo-attach-point\x3d"downloadNode"\x3e\r\n        \x3ca class\x3d"download-a" href\x3d"#" target\x3d"downloadTargetFrame" data-dojo-attach-point\x3d"downloadLinkNode"\x3e${nls.download}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"operation-item-div save-div jimu-btn" data-dojo-attach-event\x3d"onclick:_onSaveClick"\x3e\r\n        ${nls.save}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"operation-item-div cancel-div jimu-btn" data-dojo-attach-event\x3d"onclick:_onCancelClick"\x3e\r\n        ${nls.cancel}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/request dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/AGOLTemplate.html dojo/on dojo/dom dojo/_base/lang dojo/dom-construct dojo/dom-style dojo/dom-class dojo/dom-attr dojo/json dojo/query dojo/Deferred dijit/form/Select esri/request require ./ConfigNode ./Category ./CategoryManager ./ShowJsonCodePage ./utils jimu/utils jimu/WidgetManager jimu/dijit/Message jimu/dijit/Popup".split(" "),function(C,v,q,D,E,F,G,l,H,g,c,
h,w,r,I,n,y,z,O,P,A,Q,J,K,R,L,M,x,N){return C([E,F],{templateString:G,baseClass:"agol-template",configTree:null,nls:null,lastTemplateJson:null,postMixInProperties:function(){this.nls=g.mixin({},builderNls.common);this.nls=g.mixin(this.nls,builderNls.agolTemplate)},postCreate:function(){H.setSelectable(this.frontDiv,!1);this.showJsonWidget=new K({},this.showJsonContentDiv);this.configTree=new A(this.appConfig,null,"app","",0);this.categoryManager=new J(this.configTree,this.appConfig,this.app.agolTemplateJson);
this.drawTree(this.configTree,this.treePart);this.drawCategoryPart();this.initWork()},drawTree:function(a,c){var b,d;b=this.drawDomNode(a,c);if(0!==a.childs.length)for(d=0;d<a.childs.length;d++)this.drawTree(a.childs[d],b)},drawDomNode:function(a,k){var b,d,e,f,p,m;m=this.categoryManager.getCategoryByField(a.absolutePath);b=c.create("div",{"class":"tree-node-div",idAttr:a.id},k);"leaf"===a.nodeType&&!m&&h.set(b,"color","#cccccc");"leaf"!==a.nodeType&&(e=c.create("div",{"class":"show-subnode-div"},
b),f=c.create("img",{"class":"show-subnode-img",src:"builder/css/images/v_right.png",alt:"img"},e));c.create("span",{"class":"line-label-span",innerHTML:a.label?a.label:a.keyString},b);m&&"leaf"===a.nodeType&&(p=c.create("div",{"class":"to-right-div"},b),c.create("img",{"class":"to-right-img",src:"builder/css/images/add_field.png",alt:"img"},p),this.own(l(p,"click",g.hitch(this,function(d){h.set(p,"display","none");this._onToRightDiv(a,"add",b);d.stopPropagation()}))),-1!==m.findFieldFromDisplay(a.absolutePath)&&
h.set(p,"display","none"));d=12*a.level;"leaf"===a.nodeType?h.set(b,"padding-left",d+17+"px"):h.set(b,"padding-left",d+"px");d=c.create("div",{"class":"tree-node-subdiv"},k);h.set(d,"display","none");"leaf"!==a.nodeType?(h.set(b,"cursor","pointer"),this.own(l(b,"click",g.hitch(this,function(a,b,d){"none"===h.get(b,"display")?(h.set(b,"display","block"),r.set(d,"src","builder/css/images/v.png")):(h.set(b,"display","none"),r.set(d,"src","builder/css/images/v_right.png"));-1!==a.absolutePath.search(/widgets\[[0-9]+\]_config$/)&&
!a.jsonObject&&this.addWidgetConfigToConfigTree(a.absolutePath)},a,d,f)))):m&&(h.set(b,"cursor","pointer"),this.own(l(b,"click",g.hitch(this,function(a,d){this._onToRightDiv(a,"notAdd",b);d.stopPropagation()},a))));a.lineDomNode=b;a.subLineDomNode=d;a.showSubDivDomNode=e;a.toRightDiv=p;0===a.level&&(q.setStyle(b,"display","none"),q.setStyle(d,"display","block"));return d},drawCategoryPart:function(){v.forEach(this.categoryManager.displayCategorys,function(a){this.drawCategory(a)},this)},drawCategory:function(a){var k,
b,d,e,f,p,m;k=c.create("div",{"class":"category-div",categoryDiv:a.name},this.categoryPart);e=c.create("div",{"class":"category-head-div",categoryHeadDiv:a.name},k);f=c.create("div",{"class":"category-fold-div"},e);m=c.create("img",{"class":"category-fold-img",src:"builder/css/images/v_right.png",alt:"img"},f);c.create("div",{"class":"category-title-div",innerHTML:a.title},e);b=c.create("div",{"class":"category-oper-div "},e);f=c.create("div",{"class":"category-oper-item-div category-moveup-div",
innerHTML:"\x3cimg src\x3d'builder/css/images/moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},b);p=c.create("div",{"class":"category-oper-item-div category-movedown-div",innerHTML:"\x3cimg src\x3d'builder/css/images/movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},b);b=c.create("div",{"class":"category-oper-item-div category-remove-div",innerHTML:"\x3cimg src\x3d'builder/css/images/delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},b);d=c.create("div",{"class":"fields-div",fieldsDiv:a.name},k);this.own(l(f,"click",
g.hitch(this,function(b){this.categoryManager.moveup(a)&&(c.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation()})));this.own(l(p,"click",g.hitch(this,function(b){this.categoryManager.movedown(a)&&(c.empty(this.categoryPart),this.drawCategoryPart());this._changeHeighlightCategoryHead(a.name);b.stopPropagation()})));this.own(l(b,"click",g.hitch(this,function(b){this.categoryManager.removeCategoryFromDisplay(a);c.destroy(k);v.forEach(a.displayFields,
function(a){var b=this.configTree.findNode(a.fieldPath);b&&(b.setTemplateField(a.fieldJson),b.toRightDiv&&h.set(b.toRightDiv,"display","block"))},this);a.displayFields=[];b.stopPropagation()})));this.own(l(e,"click",g.hitch(this,function(){"block"===h.get(d,"display")?(h.set(d,"display","none"),r.set(m,"src","builder/css/images/v_right.png")):(h.set(d,"display","block"),r.set(m,"src","builder/css/images/v.png"));this._changeHeighlightCategoryHead(a.name)})));this.drawFields(a,k,d);h.set(d,"display",
"none")},drawFields:function(a,c,b){v.forEach(a.displayFields,function(d){this.drawField(a,c,b,d)},this)},addWidgetConfigToConfigTree:function(a){var c=new y,b=a.search(/widgets\[[0-9]+\]/),d=a.slice(b,a.length).indexOf("]"),b=a.slice(0,b+d+1);a=b+"_config";var b=this.configTree.findNode(b),e=this.configTree.findNode(a);a=this.fullAppConfig.getConfigElementById(b.jsonObject.id);a.config&&!a.config.startWith(a.folderUrl)&&(b=a.config.split("/").pop(),a.config=a.folderUrl+b);M.getInstance().tryLoadWidgetConfig(a).then(g.hitch(this,
function(a){if(a){var b;e.jsonObject=a;a.geocoder&&a.geocoder.geocoders&&delete a.geocoder.geocoders;for(b in a)a.hasOwnProperty(b)&&(b=e.addChild(a[b],b,e.absolutePath,e.level),this.drawTree(b,e.subLineDomNode))}c.resolve()}));return c},drawField:function(a,k,b,d){var e,f,p,m,B,n,s,t;this.configTree.findNode(d.fieldPath);t=A.getDefaultTemplateField(d.fieldPath,d.fieldJson.type);for(e in d.fieldJson)d.fieldJson.hasOwnProperty(e)&&(t[e]=d.fieldJson[e]);e=c.create("div",{"class":"field-div",fieldDiv:d.fieldPath},
b);this.own(l(e,"click",g.hitch(this,function(a,b){function d(){c=this.configTree.findNode(l);e=q.position(this.treePart).y;k=q.position(c.lineDomNode).y;f=k-e;(0>f||f>h.get(this.categoryPart,"height"))&&c.lineDomNode.scrollIntoView(!1);this._changeHeighlightFieldDomNode(l);this._changeHeighlightTreeDomNode(c.lineDomNode);this._changeHeighlightCategoryHead(b.name)}var c,e,k,f,l=a.fieldPath;if(c=this.configTree.findNode(l)){for(;c;)h.set(c.subLineDomNode,"display","block"),c=c.parentNode;g.hitch(this,
d)()}else this.addWidgetConfigToConfigTree(l).then(g.hitch(this,function(){for(c=this.configTree.findNode(l);c;)h.set(c.subLineDomNode,"display","block"),c=c.parentNode;g.hitch(this,d)()}))},d,a)));a=c.create("div",{"class":"field-head-div"},e);c.create("span",{"class":"field-head-title-div",innerHTML:g.hitch(this,function(a){var b="",c=a.split("_"),d=g.clone(c);v.forEach(c,function(a,b){var e,k="";if(-1!==a.search(/widgets\[[0-9]+\]$/)||-1!==a.search(/groups\[[0-9]+\]$/)){for(e=0;e<=b;e++)k+=c[e]+
"_";e=this.configTree.findNode(k.slice(0,-1));d[b]=e.label}},this);for(a=1;a<d.length;a++)b+=d[a]+"_";return b.slice(0,-1)})(d.fieldPath)},a);p=c.create("div",{"class":"field-fold-div"},a);m=c.create("img",{"class":"field-fold-img",src:"builder/css/images/v_right.png",alt:"img"},p);p=c.create("div",{"class":"field-oper-div",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'builder/css/images/delete01.png' alt\x3d'img'\x3e\x3c/img\x3e"},a);n=c.create("div",{"class":"field-oper-div",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'builder/css/images/movedown.png' alt\x3d'img'\x3e\x3c/img\x3e"},
a);B=c.create("div",{"class":"field-oper-div",innerHTML:"\x3cimg class\x3d'field-oper-img' src\x3d'builder/css/images/moveup.png' alt\x3d'img'\x3e\x3c/img\x3e"},a);var u=c.create("div",{"class":"field-fixed-content-div",style:"display:none;"},e);c.create("span",{"class":"field-label-span",innerHTML:"Field Label:"},u);f=c.create("input",{"class":"jimu-input field-label-input",type:"text",value:t.label},u);this.own(l(f,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"label",value:b.value})},
d.fieldPath,f)));c.create("span",{"class":"field-type-span",innerHTML:"Field Type:  "},u);f=(new z({name:"selectFieldType","class":"field-type-select",options:[{label:"String",value:"string"},{label:"Boolean",value:"boolean"},{label:"Number",value:"number"},{label:"Options",value:"options"}],value:t.type})).placeAt(u);s=c.create("div",{"class":"field-content-div",style:"display:none;"},e);this.drawFieldContent(d.fieldPath,t,s,f.getValue());this.own(l(f,"change",g.hitch(this,function(a,b,c,d){this.drawFieldContent(a,
b,c,d);this._onFieldChange(a,{key:"type",value:d});h.set(c,"display","block")},d.fieldPath,t,s)));this.own(l(a,"click",g.hitch(this,function(){"block"===h.get(s,"display")?(h.set(s,"display","none"),h.set(u,"display","none"),r.set(m,"src","builder/css/images/v_right.png")):(h.set(s,"display","block"),h.set(u,"display","block"),r.set(m,"src","builder/css/images/v.png"))})));this.own(l(p,"click",g.hitch(this,function(a,b,d,e){var k=a.fieldPath,f=this.configTree.findNode(k);f?(f.setTemplateField(a.fieldJson),
f.toRightDiv&&h.set(f.toRightDiv,"display","block")):this.addWidgetConfigToConfigTree(k).then(g.hitch(this,function(){var b=this.configTree.findNode(k);a.fieldJson&&b.setTemplateField(a.fieldJson)}));f=this.categoryManager.getCategoryByField(k);f.removeFieldFromDisplay(k);c.destroy(b);f.displayIsEmpty()&&(this.categoryManager.removeCategoryFromDisplay(f),c.destroy(d));e.stopPropagation()},d,e,k)));this.own(l(B,"click",g.hitch(this,function(a,b,d){var e=this.categoryManager.getCategoryByField(a);e.moveup(a)&&
(c.empty(b),this.drawFields(e,k,b),this._changeHeighlightFieldDomNode(a));d.stopPropagation()},d.fieldPath,b)));this.own(l(n,"click",g.hitch(this,function(a,b,d){var e=this.categoryManager.getCategoryByField(a);e.movedown(a)&&(c.empty(b),this.drawFields(e,k,b),this._changeHeighlightFieldDomNode(a));d.stopPropagation()},d.fieldPath,b)))},drawFieldContent:function(a,k,b,d){var e,f,h,m;c.empty(b);c.create("span",{"class":"field-tooltip-span",innerHTML:"Tooltip:"},b);e=c.create("input",{"class":"jimu-input field-tooltip-input",
type:"text",value:k.tooltip},b);this.own(l(e,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"tooltip",value:b.value})},a,e)));c.create("br",{},b);"string"===d?(c.create("span",{"class":"field-string-ph-span",innerHTML:"Placeholder:"},b),d=c.create("input",{"class":"jimu-input field-string-ph-input",type:"text",value:k.placeHolder},b),this.own(l(d,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"placeHolder",value:b.value})},a,d))),d=c.create("div",{"class":"field-text-type-div"},
b),c.create("span",{"class":"field-text-type-span",innerHTML:"Text Box Type:"},d),k=(new z({name:"stringOptions","class":"field-string-options",options:[{label:"richtext",value:"richtext"},{label:"textarea",value:"textarea"},{label:"textbox",value:"textbox"}],value:k.stringFieldOption})).placeAt(d),this.own(l(k,"change",g.hitch(this,function(a,b){this._onFieldChange(a,{key:"stringFieldOptions",value:b})},a)))):"number"===d?(c.create("span",{"class":"field-num-min-span",innerHTML:"Min Value:"},b),
f=c.create("input",{"class":"jimu-input field-num-input field-num-min-input",type:"text",value:k.constraints.min},b),c.create("br",{},b),c.create("span",{"class":"field-num-max-span",innerHTML:"Max Value:"},b),h=c.create("input",{"class":"jimu-input field-num-input field-num-max-input",type:"text",value:k.constraints.max},b),c.create("br",{},b),c.create("span",{"class":"field-num-places-span",innerHTML:"Places:"},b),m=c.create("input",{"class":"jimu-input field-num-input field-num-places-input",type:"text",
value:k.constraints.places},b),this.own(l(f,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:f.value,max:h.value,places:m.value}})},a))),this.own(l(h,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:f.value,max:h.value,places:m.value}})},a))),this.own(l(m,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"constraints",value:{min:f.value,max:h.value,places:m.value}})},a)))):"options"===d&&(d=c.create("div",{"class":"field-options-add-div"},
b),e=c.create("div",{"class":"field-options-add-content"},d),c.create("div",{"class":"field-options-add-img-div",innerHTML:"\x3cimg src\x3d'builder/css/images/add_link.png' alt\x3d'img'\x3e\x3c/img\x3e"},e),c.create("div",{"class":"field-options-add-text-div",innerHTML:"Add a New Options"},e),v.forEach(k.options,function(d){this._onFieldOptionsAdd(a,b,d.label,d.value)},this),this.own(l(d,"click",g.hitch(this,this._onFieldOptionsAdd,a,b,"",""))))},_changeHeighlightFieldDomNode:function(a){n(".field-div",
this.categoryPart).removeClass("field-heighlight-div");w.add(n('div[fieldDiv\x3d"'+a+'"]',this.categoryPart)[0],"field-heighlight-div")},_changeHeighlightTreeDomNode:function(a){this.heighlightTreeDomNode&&w.remove(this.heighlightTreeDomNode,"tree-node-heighlight-div");w.add(a,"tree-node-heighlight-div");this.heighlightTreeDomNode=a},_changeHeighlightCategoryHead:function(a){n(".category-head-div",this.categoryPart).removeClass("category-head-div-selected");a=n("div[categoryHeadDiv\x3d'"+a+"']",this.categoryPart)[0];
q.addClass(a,"category-head-div-selected")},_onToRightDiv:function(a,c,b){var d,e,f=this.categoryManager.getCategoryByField(a.absolutePath);d=this.categoryManager.findDisplayCategory(f.name);e={fieldPath:a.absolutePath,fieldJson:a.getTemplateField()};if(-1===d){if("add"!==c)return;this.categoryManager.addCategoryToDisplay(f);f.addFieldToDisplay(e);this.drawCategory(f);d=n("div[fieldsDiv\x3d'"+f.name+"']",this.categoryPart)[0]}else if(-1===f.findFieldFromDisplay(a.absolutePath)){if("add"!==c)return;
f.addFieldToDisplay(e);c=n("div[categoryDiv\x3d'"+f.name+"']",this.categoryPart)[0];d=n("div[fieldsDiv\x3d'"+f.name+"']",this.categoryPart)[0];this.drawField(f,c,d,e)}else d=n("div[fieldsDiv\x3d'"+f.name+"']",this.categoryPart)[0];h.set(d,"display","block");e=n('div[fieldDiv\x3d"'+a.absolutePath+'"]',this.categoryPart)[0];this._changeHeighlightCategoryHead(f.name);this._changeHeighlightFieldDomNode(a.absolutePath);this._changeHeighlightTreeDomNode(b);a=q.position(this.categoryPart).y;a=q.position(e).y-
a;(0>a||a>h.get(this.categoryPart,"height"))&&e.scrollIntoView(!1)},_onFieldChange:function(a,c){var b=this.configTree.findNode(a),d=this.categoryManager.getCategoryByField(a).getDisplayField(a);d.fieldJson[c.key]=c.value;b.templateField=d.fieldJson},_onFieldOptionsAdd:function(a,k,b,d){var e=c.create("div",{"class":"field-options-div"},k);c.create("div",{"class":"field-options-label-div",innerHTML:"Label"},e);b=c.create("input",{"class":"jimu-input field-options-label-input",type:"text",value:b},
e);this.own(l(b,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(k)})},a)));c.create("div",{"class":"field-options-value-div",innerHTML:"Value"},e);d=c.create("input",{"class":"jimu-input field-options-value-input",type:"text",value:d},e);this.own(l(d,"change",g.hitch(this,function(a){this._onFieldChange(a,{key:"options",value:this._getFieldOptions(k)})},a)));d=c.create("div",{"class":"field-options-remove-div",innerHTML:"\x3cimg src\x3d'builder/css/images/delete_search.png' alt\x3d'img'\x3e\x3c/img\x3e"},
e);this.own(l(d,"click",g.hitch(this,function(a){c.destroy(e);this._onFieldChange(a,{key:"options",value:this._getFieldOptions(k)})},a)))},_getFieldOptions:function(a){var c=[];n(".field-options-div",a).forEach(g.hitch(this,function(a){c.push({label:n(".field-options-label-input",a).attr("value")[0],value:n(".field-options-value-input",a).attr("value")[0]})}));return c},_onReviewJsonDivClick:function(){var a=this.categoryManager.getTemplateJson();this.showJsonWidget.setConfig(a);r.set(this.rightPartHeadText,
"innerHTML",this.nls.rightPartHead2);h.set(this.showJsonDiv,"display","block");h.set(this.reviewJsonDiv,"display","none");h.set(this.reviewJsonBackDiv,"display","block")},_onReviewJsonBackDivClick:function(){r.set(this.rightPartHeadText,"innerHTML",this.nls.rightPartHead);h.set(this.reviewJsonDiv,"display","block");h.set(this.reviewJsonBackDiv,"display","none");h.set(this.showJsonDiv,"display","none")},_updateAgolTemplate:function(){var a=new y,c=I.stringify(this.categoryManager.getTemplateJson("fullJson"));
D("/builder/rest/apps/updateagoltemplateinapp",{handleAs:"json",method:"POST",data:{id:this.app.id,name:this.app.name,agolTemplateJson:c}}).then(g.hitch(this,function(b){!0===b.success?(this.app.agolTemplateJson=c,this.lastTemplateJson=this.categoryManager.getTemplateJson(),a.resolve()):(a.reject(),new x({message:"Save agol template failed!"}))}),function(b){a.reject();new x({message:"Save agol template failed!"})});return a},_onSaveClick:function(){this._updateAgolTemplate().then(g.hitch(this,function(){q.setAttr(this.downloadLinkNode,
"href","/builder/rest/apps/"+this.app.id+"/downloadagoltemplate");q.addClass(this.downloadLinkNode,"download-div-enable");q.removeClass(this.downloadNode,"jimu-state-disabled");new x({message:this.nls.saveSuccessMeg})}))},_onCancelClick:function(){if(L.isEqual(this.lastTemplateJson,this.categoryManager.getTemplateJson()))this.destroyRecursive();else var a=new N({content:"\x3cdiv\x3e\x3cimg class\x3d'alert-image' src\x3d'builder/css/images/alert.png' style\x3d'float:left;margin-left:12px;margin-right:22px;'\x3e\x3c/img\x3e"+
this.nls.unSaveMeg+"\x3c/div\x3e",titleLabel:this.nls.cancelPopupTitle,width:"425",autoHeight:!0,buttons:[{label:this.nls.save,onClick:g.hitch(this,function(){this._updateAgolTemplate().then(g.hitch(this,function(){a.close();this.destroyRecursive()}))})},{label:this.nls.doNotSave,onClick:g.hitch(this,function(){a.close();this.destroyRecursive()})},{label:this.nls.cancel,onClick:g.hitch(this,function(){a.close()})}]})},initWork:function(){this.app.agolTemplateJson&&(q.setAttr(this.downloadLinkNode,
"href","/builder/rest/apps/"+this.app.id+"/downloadagoltemplate"),q.addClass(this.downloadLinkNode,"download-div-enable"),q.removeClass(this.downloadNode,"jimu-state-disabled"));this.lastTemplateJson=this.categoryManager.getTemplateJson()}})});