//>>built
require({cache:{"builder/SetPortalUrl":function(){define("dojo/parser dojo/on dojo/dom dojo/_base/lang dojo/_base/declare dojo/_base/html dojo/topic dojo/_base/config dojox/validate/regexp dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SetPortalUrl.html dojo/Evented dojo/request dojo/request/script dojo/Deferred dojo/keys jimu/dijit/URLInput jimu/dijit/Message jimu/portalUtils jimu/portalUrlUtils jimu/utils builder/tokenUtils dijit/form/TextBox esri/request".split(" "),
function(v,c,w,d,g,b,e,f,D,k,p,n,z,E,q,F,s,x,A,y,G,u,r,h,H,m){return g([E,k,p,n],{baseClass:"jimu-set-portal-url",templateString:z,label:"setportalurl",invalidInput:!0,_enterKeyDown:!1,_continueClick:!1,currentDef:null,signinInfo:null,postMixInProperties:function(){this.nls=window.builderNls.setPortalUrl;this.nls.continueBtn=this.nls.continueBtn||"Continue";this.nls.example=this.nls.example||"Example";this.nls.faq=this.nls.faq||"FAQs"},postCreate:function(){this.loadingUrl=b.create("div",{"class":"loadingUrl"},
this.portalUrlInput.domNode);this.invalidUrl=b.create("div",{"class":"invalidUrl"},this.portalUrlInput.domNode);this.validUrl=b.create("div",{"class":"validUrl"},this.portalUrlInput.domNode);this.signinInfo={portalUrl:"",supportsOAuth:!1,appId:null};b.addClass(this.portalUrlInput.domNode,"portalUrlInput");this._getFAQHelpLink().then(d.hitch(this,function(a){b.setStyle(this.faqNode,"display","inline-block");b.setAttr(this.faqNode,"href",a)}))},_getFAQHelpLink:function(){var a=new s;window.isXT?q("/webappbuilder/help/cxhelp.js",
{handleAs:"json"}).then(d.hitch(this,function(b){var B="#";b&&(b.m&&b.m["120000962"])&&(B="/webappbuilder/help/"+b.m["120000962"]);a.resolve(B)}),d.hitch(this,function(b){console.warn(b);a.resolve("#")})):a.resolve("#");return a},setSigninInfo:function(a){var b=new s;b.then(d.hitch(this,function(a){a.portalUrl&&this.portalUrlInput.set("value",a.portalUrl);this._validatePortal()}),d.hitch(this,function(a){new y({message:a})}));a?(this.signinInfo=a,b.resolve(a)):q("/builder/rest/signininfo/getcurrentinfo",
{handleAs:"json"}).then(function(c){c.success?(this.signinInfo=a,b.resolve(c.info)):(console.error(c.message),b.reject(c.message))})},_onContentKeyDown:function(a){(a.keyCode?a.keyCode:a.which)===x.ENTER?(this.portalUrlInput.onBlur(),this._enterKeyDown=!0,this.savePortalUrlBtn.focus(),this.savePortalUrlBtn.click()):this._continueClick=this._enterKeyDown=!1},_onPortalUrlFocus:function(){},_onPortalUrlKeyDown:function(){this._cancelValidating()},_cancelValidating:function(){this.currentDef&&!this.currentDef.isCanceled()&&
(this.currentDef.cancel(),b.setStyle(this.invalidUrl,"display","none"),b.setStyle(this.errorRemind,"display","none"))},_onPortalUrlChange:function(){this.invalidInput=!0},_updateSigninInfo:function(a){return q("/builder/rest/signininfo/setsignininfo",{handleAs:"json",data:a,method:"POST"})},_allowNamedorLocal:function(a){var b="^"+D.url({allowNamed:!1,allLocal:!1});return RegExp(b,"g").test(a)},_isValidPortalUrl:function(a){var b=new s;a=u.getPortalSelfInfoUrl(a);a=u.setHttpsProtocol(a);this.currentDef=
m({url:a,content:{f:"json"},handleAs:"json",timeout:1E4},{useProxy:!0});this.currentDef.then(d.hitch(this,function(){b.resolve(!0)}),d.hitch(this,function(a){a=a.status||a.xhr||a.xhr.status;401===a||403===a?b.resolve(!0):b.resolve(!1)}));return b},_validatePortal:function(){this.portalUrlInput.get("value")?b.setStyle(this.remind,"display","none"):b.setStyle(this.remind,"display","block");var a=this.portalUrlInput.get("value");a&&(this.portalUrlInput.validator(this.portalUrlInput.get("value"))&&(a=
this.portalUrlInput.get("value")),/www.arcgis.com/.test(a)||!this._allowNamedorLocal(a)?this._showInvalidStatus():(this._showValidatingStatus(),a=u.getStandardPortalUrl(a),this._isValidPortalUrl(a).then(d.hitch(this,function(b){b?this._isWebTierPortal(a):(this._showInvalidStatus(),console.log("Invalid portalUrl"))}),d.hitch(this,function(){this._showInvalidStatus();console.log("Invalid portalUrl")}))))},_isWebTierPortal:function(a){this.currentDef=h.isWebTierPortal(a);this.currentDef.then(d.hitch(this,
function(b){var c=m({url:a+"/sharing/rest/portals/self",content:{f:"json"},handleAs:"json",timeout:15E3,callbackParamName:"callback"});this.currentDef=c;b?((b=h.getPortalCredential(a))&&e.publish("userSignIn",b),e.publish("disableWebTierUserSignOut"),c.then(d.hitch(this,function(b){this.signinInfo={portalUrl:a,supportsOAuth:b.supportsOAuth,isWebTier:!0};this.currentDef=this._updateSigninInfo(this.signinInfo);this.currentDef.then(d.hitch(this,function(a){var b=d.clone(this.signinInfo);this._showValidStatus();
a.success?e.publish("switchToMainPage",b):(this._showInvalidStatus(),console.error("fail to update signinInfo",b))}),d.hitch(this,function(a){this._showInvalidStatus();console.error("fail to update signinInfo",a)}))}),d.hitch(this,function(a){console.error("fail to get portal self infomation",a);this._showInvalidStatus()}))):c.then(d.hitch(this,function(b){!b.isPortal&&!b.urlKey?(this._showInvalidStatus(),console.error("invalid name")):(this.signinInfo.supportsOAuth=b.supportsOAuth,this._validateHasAppId(a).always(d.hitch(this,
function(){this._showValidStatus();if(this._enterKeyDown||this._continueClick)this._onContinue(),this._enterKeyDown=this._continueClick=!1})),this.signinInfo.portalUrl=a,this.emit("valid-url-change",{portalUrl:a}),e.publish("portalUrlChange",{portalUrl:a}))}),d.hitch(this,function(a){this._showInvalidStatus();console.error(a)}))}),d.hitch(this,function(a){this._showInvalidStatus();console.error(a)}))},_validateHasAppId:function(a){var b=new s;q("/builder/rest/signininfo/getAppId",{handleAs:"json",
query:{portalUrl:a}}).then(d.hitch(this,function(a){a&&a.success?this.signinInfo.appId=a.appId:(this.signinInfo.appId=null,new y({message:a.message}));b.resolve(a)}),d.hitch(this,function(a){this.signinInfo.appId=null;b.reject("error");console.error(a)}));return b.promise},_showValidStatus:function(){b.removeClass(this.portalUrlInput.domNode,"errorStatus");b.setStyle(this.loadingUrl,"display","none");b.setStyle(this.validUrl,"display","block");b.setStyle(this.invalidUrl,"display","none");b.setStyle(this.errorRemind,
"display","none");this.invalidInput=!1},_showValidatingStatus:function(){b.removeClass(this.portalUrlInput.domNode,"errorStatus");b.setStyle(this.loadingUrl,"display","block");b.setStyle(this.validUrl,"display","none");b.setStyle(this.invalidUrl,"display","none");b.setStyle(this.errorRemind,"display","none");this.invalidInput=!0},_showInvalidStatus:function(){b.addClass(this.portalUrlInput.domNode,"errorStatus");b.setStyle(this.portalUrlInput.domNode,"data-dojo-props","missingMessage:'IPUT URL'");
b.setStyle(this.loadingUrl,"display","none");b.setStyle(this.validUrl,"display","none");b.setStyle(this.invalidUrl,"display","block");b.setStyle(this.errorRemind,"display","block");var a=this.portalUrlInput.get("value");/www.arcgis.com/.test(a)||!this._allowNamedorLocal(a)?this.errorRemind.innerHTML=this.nls.errOrg:this.errorRemind.innerHTML=this.nls.errPrefix+a+"\x3cbr\x3e"+this.nls.errRemind;this.invalidInput=!0},_onContinue:function(){this.invalidInput?(this._validatePortal(),this._continueClick=
!0):e.publish("switchToSignin",d.clone(this.signinInfo))}})})},"builder/PortalSignIn":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/on dojo/topic dojo/_base/html dojo/dom-form dojo/_base/sniff dojo/request/registry dojo/keys dojo/cookie dojo/json dojo/aspect dojo/Deferred dojo/promise/all dojo/io-query dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/PortalSignIn.html esri/lang esri/request esri/arcgis/OAuthInfo esri/IdentityManager jimu/portalUrlUtils jimu/portalUtils jimu/utils jimu/dijit/CheckBox jimu/dijit/LoadingShelter jimu/dijit/Message builder/tokenUtils".split(" "),
function(v,c,w,d,g,b,e,f,D,k,p,n,z,E,q,F,s,x,A,y,G,u,r,h,H,m,a,I,B,K,J,C){return v([x,A,y],{templateString:G,nls:null,defaultExpires:20160,removeOldAppId:!1,label:"signin",postMixInProperties:function(){this.inherited(arguments);this.nls=window.builderNls.portalSignIn},postCreate:function(){this.inherited(arguments);this._bindEvents()},showAppIdTip:function(){e.setStyle(this.appIdTipSection,"display","block")},hideAppIdTip:function(){e.setStyle(this.appIdTipSection,"display","none")},_bindEvents:function(){this.remember=
new B({label:this.nls.remember,checked:!1},this.remember);this.own(g(this.password,"blur",c.hitch(this,this.changeSigninStatus)));this.own(g(this.domNode,"keydown",c.hitch(this,function(a){if((a.keyCode?a.keyCode:a.which)===p.ENTER)this.onSigninClick()})))},generateTokenSignIn:function(a){var t=new q,d=C.xtGetCredentialFromCookie(a);if(d)return t.resolve(d.token),t;C.removeWabAuthCookie();var f=this._standardizePortalUrl(m.getStandardPortalUrl(a));a="/proxy.js?"+f+"/sharing/generateToken";this.shelter.show(this.nls.signingIn+
"...");k(a,{handleAs:"json",method:"POST",data:{request:"getToken",username:e.getAttr(this.username,"value"),password:e.getAttr(this.password,"value"),referer:window.location.host,expiration:this.remember.checked?this.defaultExpires:120,f:"json"},headers:{"X-Requested-With":null}}).then(c.hitch(this,function(a){if(a&&a.token){this._clearUserPassword();var l="/proxy.js?"+m.getCommunitySelfUrl(f),d=this._getPortalSelf(a.token),l=k(l,{handleAs:"json",method:"POST",data:{token:a.token,f:"json"},headers:{"X-Requested-With":null}});
F([d,l]).then(c.hitch(this,function(l){this.shelter.hide();var c=l[0];l=l[1];l.orgId?(c.isPortal||(this.signinInfo.portalUrl="http://"+c.urlKey+"."+c.customBaseUrl),l.username&&(c={server:m.getStandardPortalUrl(this.signinInfo.portalUrl),token:a.token,userId:l.username,expires:a.expires,referer:window.location.host,scope:"portal",isAdmin:"org_admin"===l.role},l=C.saveAndRegisterCookieToCredential(c),b.publish("userSignIn",l),t.resolve(c))):new J({message:this.nls.namedUserTip,container:document.body})}),
c.hitch(this,function(a){console.error(a);this._loginStatus(!0);t.reject(a)}))}else this.shelter.hide(),this._loginStatus(!0),t.reject()}),c.hitch(this,function(a){this.shelter.hide();console.error(a);this._loginStatus(!0);t.reject(a)}));return t},setSigninInfo:function(a,b){this.signinInfo=a;e.setStyle(this.domNode,"display","block");var d=m.getStandardPortalUrl(a.portalUrl);this.forgot.href=d+"/home/troubleshoot.html";if(a.supportsOAuth&&a.appId&&!b)e.setStyle(this.domNode,"display","none"),this._updateSigninInfo(a).then(c.hitch(this,
function(){this.oauthSignIn(a.portalUrl,a.appId)}));else if(C.xtGetCredentialFromCookie(a.portalUrl))this.onSigninClick();this.signinInfo.supportsOAuth?this.showAppIdTip():this.hideAppIdTip()},oauthSignIn:function(a,b){if(!a||!("string"===typeof a&&b&&"string"===typeof b))return null;var c=this._standardizePortalUrl(a),d=new h({appId:b,portalUrl:c,expiration:this.defaultExpires,authNamespace:"/",popup:!1});H.registerOAuthInfos([d]);H.getCredential(c+"/sharing")},removeCookie:function(a){I.removeCookie(a,
"/")},saveWabCookie:function(a){this.removeCookie("wab_auth");n("wab_auth",z.stringify(a),{expires:new Date(a.expires),path:"/"})},_standardizePortalUrl:function(a){a=m.getStandardPortalUrl(a);return a=m.setHttpsProtocol(a)},_createAppId:function(b){var d=new q;b=a.getPortal(b);var f=["http://"+window.location.hostname,"https://"+window.location.hostname];this.shelter.show(this.nls.registeringAppID+"...");b.createAndRegisterApp(f).then(c.hitch(this,function(a){this.shelter.hide();d.resolve(a)}),c.hitch(this,
function(a){this.shelter.hide();console.error(a);d.reject(a)}));return d},_getPortalSelf:function(a){return r({url:m.getPortalSelfInfoUrl(this.signinInfo.portalUrl),content:{f:"json",token:a},handleAs:"json",callbackParamName:"callback"})},_signInAndCreateAppId:function(){this.generateTokenSignIn(this.signinInfo.portalUrl).then(c.hitch(this,function(){if(this.signinInfo.supportsOAuth)this._createAppId(this.signinInfo.portalUrl).then(c.hitch(this,function(a){var d={portalUrl:this.signinInfo.portalUrl,
appId:a.client_id,supportsOAuth:this.signinInfo.supportsOAuth};this._updateSigninInfo(d).then(c.hitch(this,function(a){a.success?b.publish("switchToMainPage",d):console.log(a)}),function(a){console.log(a)})}),c.hitch(this,function(a){console.error(a)}));else{var a={portalUrl:this.signinInfo.portalUrl,supportsOAuth:this.signinInfo.supportsOAuth};this._updateSigninInfo(a).then(c.hitch(this,function(c){c.success?b.publish("switchToMainPage",a):console.log(c)}),function(a){console.log(a)})}}),c.hitch(this,
function(a){console.error(a)}))},_signInAndRecrateAppId:function(){this.generateTokenSignIn(this.signinInfo.portalUrl).then(c.hitch(this,function(){var d=this.signinInfo.appId,f=this.signinInfo.portalUrl,m=this.signinInfo.supportsOAuth,e=a.getPortal(f);e.getAppById(d).promise.always(c.hitch(this,function(a){var d=a&&a.itemId,k=c.hitch(this,function(){this._createAppId(f).then(c.hitch(this,function(a){var d={portalUrl:f,appId:a.client_id,supportsOAuth:m};this._updateSigninInfo(d).then(c.hitch(this,
function(a){a.success?b.publish("switchToMainPage",d):console.error(a)}),function(a){console.error(a)})}),c.hitch(this,function(a){console.error(a)}))});d?e.getUser().then(c.hitch(this,function(a){a.deleteItem(d).then(c.hitch(this,function(a){a.success&&k()}),c.hitch(this,function(a){console.error(a)}))}),c.hitch(this,function(a){console.error(a)})):k()}))}),c.hitch(this,function(a){console.error(a)}))},onSigninClick:function(){this.removeOldAppId?this._signInAndRecrateAppId():this._signInAndCreateAppId()},
onBackClick:function(){b.publish("switchToSetPortalUrl",this.signinInfo)},_updateSigninInfo:function(a){return k("/builder/rest/signininfo/setsignininfo",{handleAs:"json",data:a,method:"POST"})},_loginStatus:function(a){a?(this.username.focus(),e.setStyle(this.errorNode,"display","block")):e.setStyle(this.errorNode,"display","none")},_clearUserPassword:function(){this.username.value="";this.password.value=""},changeSigninStatus:function(){this.password.value?e.removeClass(this.signin,"signin-btn-disable"):
e.hasClass(this.signin,"signin-btn-disable")||e.addClass(this.signin,"signin-btn-disable")}})})},"dojo/request/registry":function(){define(["require","../_base/array","./default!platform","./util"],function(v,c,w,d){function g(b,c){for(var d=e.slice(0),p=0,n;n=d[p++];)if(n(b,c))return n.request.call(null,b,c);return w.apply(null,arguments)}function b(b,c){var d;c?(d=b.test?function(c){return b.test(c)}:b.apply&&b.call?function(){return b.apply(null,arguments)}:function(c){return c===b},d.request=
c):(d=function(){return!0},d.request=b);return d}var e=[];g.register=function(d,g,k){var p=b(d,g);e[k?"unshift":"push"](p);return{remove:function(){var b;~(b=c.indexOf(e,p))&&e.splice(b,1)}}};g.load=function(b,c,d,e){b?v([b],function(b){w=b;d(g)}):d(g)};d.addCommonMethods(g);return g})},"url:builder/templates/SetPortalUrl.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"content" data-dojo-attach-point\x3d"portalContent" data-dojo-attach-event\x3d"keydown: _onContentKeyDown"\x3e\r\n    \x3cp class \x3d "specify-text-url"\x3e${nls.tip}\x3c/p\x3e \r\n\r\n    \x3cdiv class\x3d"portalUrlDiv" id\x3d"portalUrlDiv"\x3e\r\n      \x3cinput class\x3d"portalUrlInput" data-dojo-attach-point\x3d"portalUrlInput" name\x3d"portalUrl" type\x3d"text"\r\n      data-dojo-type\x3d"jimu/dijit/URLInput" data-dojo-attach-event\x3d"Focus:_onPortalUrlFocus,Blur:_validatePortal,KeyDown: _onPortalUrlKeyDown,Change:_onPortalUrlChange"\r\n      data-dojo-props\x3d"rest:false,missingMessage:\'Please input portalUrl.\', invalidMessage: \'Invalid Portal URL\', allowNamed:true, allowLocal:true" /\x3e\r\n      \x3cdiv class\x3d"Remind" data-dojo-attach-point\x3d"remind" \x3e \r\n        \x3ctable\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd\x3e${nls.example}:\x3c/td\x3e\x3ctd\x3ehttp://myportal.company.com/arcgis\x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd\x3e\x3c/td\x3e\x3ctd\x3ehttp://orgname.maps.arcgis.com\x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"errorRemind" data-dojo-attach-point\x3d"errorRemind"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"ContinueBtn" data-dojo-attach-point\x3d"savePortalUrlBtn" data-dojo-attach-event\x3d"click:_onContinue"\x3e\r\n      ${nls.continueBtn}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"trouble-shooting"\x3e\r\n      \x3ca data-dojo-attach-point\x3d"faqNode" target\x3d"_blank"\x3e${nls.faq}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:builder/templates/PortalSignIn.html":'\x3cdiv class\x3d"jimu-portal-signin"\x3e\r\n  \x3clabel data-dojo-attach-point\x3d"errorNode" class\x3d"error-message"\x3e${nls.errorMessage}\x3c/label\x3e\r\n  \x3cdiv class\x3d"signin-content" data-dojo-attach-point\x3d"signinContentNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"appIdTipSection" class\x3d"appid-tip-section"\x3e\r\n      \x3cdiv\x3e${nls.appIdTip1}\x3c/div\x3e\r\n      \x3cdiv style\x3d"margin-top:20px;"\x3e\r\n        \x3cspan\x3e${nls.appIdTip2}\x3c/span\x3e\r\n        \x3ca class\x3dhelp-link target\x3d_blank href\x3d"http://doc.arcgis.com/en/arcgis-online/share-maps/add-items.htm#ESRI_SECTION2_20AF85308FD548B5ADBAE28836F66D3F"\x3e${nls.here}\x3c/a\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"form"\x3e\r\n      \x3clabel\x3e${nls.username}\x3c/label\x3e\r\n      \x3cinput type\x3d"text" tabindex\x3d"1" data-dojo-attach-point\x3d"username" /\x3e\r\n      \x3clabel\x3e${nls.password}\x3c/label\x3e\r\n      \x3ca data-dojo-attach-point\x3d"forgot" style\x3d"margin-left:10px;" target\x3d"_blank" href\x3d"#"\x3e${nls.forgot}\x3c/a\x3e\r\n      \x3cinput type\x3d"password" tabindex\x3d"2" data-dojo-attach-point\x3d"password" /\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"remember"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"operations"\x3e\r\n      \x3cdiv class\x3d"btn signin-btn" data-dojo-attach-point\x3d"signin" tabindex\x3d"3" data-dojo-attach-event\x3d"onClick:onSigninClick" \x3e${nls.con}\x3c/div\x3e\r\n      \x3cdiv class\x3d"btn btn-back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:onBackClick"\x3e${nls.back}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/parser dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/cookie dojo/request/xhr dojo/topic dijit/registry builder/tokenUtils jimu jimu/utils jimu/portalUrlUtils jimu/portalUtils jimu/dijit/ViewStack jimu/dijit/LoadingShelter ./SetPortalUrl ./PortalSignIn esri/config esri/urlUtils esri/request esri/IdentityManager".split(" "),function(v,c,w,d,g,b,e,f,D,k,p,n,z,E,q,F,s,x,A,y,G,u){function r(b){c.setStyle("pre-main-page","display","block");c.setStyle("main-page","display","none");
null===h&&(h=new q({viewType:"dijit",views:[new s({},"portal-url-div"),new x({},"signin-div")]},"pre-main-page"),h.switchView("setportalurl"))}var h=null;f.subscribe("switchToSetPortalUrl",function(b){r();h.switchView("setportalurl");h.getViewByLabel("setportalurl").setSigninInfo(b)});f.subscribe("switchToSignin",function(b){r();var c=window.location.href.replace(/(action=)(.+)/,"$1signin");n.changeLocation(c);h.switchView("signin");h.getViewByLabel("signin").setSigninInfo(b)});k.removeEsriAuthCookieStorage();
u._oAuthDfd=null;(function(){A.defaults.io.proxyUrl="/proxy.js";e("/builder/rest/signininfo/getcurrentinfo",{handleAs:"json"}).then(function(b){if(b.success){b=b.info;var c;c=window.originalHash.replace("#","");c=n.hashToObject(c);if(c.access_token){var a=window.location.href.replace(/[\?|\&](action=)(.+)/,"");n.changeLocation(a);c=k.registerAuth2Hash(c);f.publish("userSignIn",c);f.publish("switchToMainPage",b)}else c.error&&c.error_description?"invalid_request"===c.error?(r(b),h.switchView("signin"),
c=h.getViewByLabel("signin"),c.removeOldAppId=!0,c.setSigninInfo(b,!0)):f.publish("switchToSetPortalUrl",b):"setportalurl"===queryObject.action?(r(),f.publish("switchToSetPortalUrl",b)):"signin"===queryObject.action?(r(),f.publish("switchToSignin",b)):f.publish("switchToMainPage",b)}else console.log(b.message)})})()});