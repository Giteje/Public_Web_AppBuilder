//>>built
require({cache:{"url:builder/config/templates/MapTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"allMapsSection"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"allMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"allMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"maps-section" data-dojo-attach-point\x3d"filteredMapsSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"maps-table-div" data-dojo-attach-point\x3d"filteredMapsTableDiv"\x3e\r\n\t\t\t\x3ctable class\x3d"maps-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredMapsTable"\x3e\r\n\t\t\t\t\x3ctbody class\x3d"maps-tbody" data-dojo-attach-point\x3d"filteredMapsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredMapsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/MapTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils builder/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),function(r,s,t,u,v,w,d,x,b,A,e,l,y,q,z,B){return r([s,t,u,w],{templateString:v,baseClass:"map-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,originalSelectedId:null,
postMixInProperties:function(){this.nls=d.mixin({},builderNls.common);this.nls=d.mixin(this.nls,builderNls.mapConfig)},postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=z.getStandardPortalUrl(this.portalUrl));this.own(l(this.allMapsTableDiv,"scroll",d.hitch(this,this._onAllMapsSectionScroll)));this.own(l(this.filteredMapsTableDiv,"scroll",d.hitch(this,this._onFilteredMapsSectionScroll)));this.showAllMapsSection();this.searchAllMaps()},
show:function(){b.setStyle(this.domNode,"display","block")},hide:function(){b.setStyle(this.domNode,"display","none")},searchAllMaps:function(a){this.showAllMapsSection();a&&(this.query=d.mixin({},a),this.query.start=1,this.clearAllMapsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allMapsShelter.show(),q.getPortal(this.portalUrl).queryItems(this.query).then(d.hitch(this,function(a){this.domNode&&(this.allMapsShelter.hide(),this.query.start=a.nextStart,this._createMapItems(a,this.allMapsTbody))}),
d.hitch(this,function(a){this.domNode&&this.allMapsShelter.hide()})))},searchFilteredMaps:function(a){this.showFilterMapsSection();a&&(this.filteredQuery=d.mixin({},a),this.filteredQuery.start=1,this.clearFilteredMapsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredMapsShelter.show(),q.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(d.hitch(this,function(a){this.domNode&&(this.filteredMapsShelter.hide(),this.filteredQuery.start=a.nextStart,this._createMapItems(a,
this.filteredMapsTbody),0===this._getWebMapCount(this.filteredMapsTbody)&&(b.setStyle(this.filteredMapsTableDiv,"display","none"),b.setStyle(this.searchNoneTipSection,"display","block")))}),d.hitch(this,function(a){this.domNode&&(this.filteredMapsShelter.hide(),0===this._getWebMapCount(this.filteredMapsTbody)&&(b.setStyle(this.filteredMapsTableDiv,"display","none"),b.setStyle(this.searchNoneTipSection,"display","block")))})))},clear:function(){this.clearAllMapsSection();this.clearFilteredMapsSection()},
clearAllMapsSection:function(){b.empty(this.allMapsTbody)},clearFilteredMapsSection:function(){b.empty(this.filteredMapsTbody)},showAllMapsSection:function(){b.setStyle(this.allMapsSection,"display","block");b.setStyle(this.filteredMapsSection,"display","none")},showFilterMapsSection:function(){b.setStyle(this.allMapsSection,"display","none");b.setStyle(this.filteredMapsSection,"display","block");b.setStyle(this.filteredMapsTableDiv,"display","block");b.setStyle(this.searchNoneTipSection,"display",
"none")},_onAllMapsSectionScroll:function(){this._isScrollToBottom(this.allMapsTableDiv)&&this.searchAllMaps()},_onFilteredMapsSectionScroll:function(){this._isScrollToBottom(this.filteredMapsTableDiv)&&this.searchFilteredMaps()},_isScrollToBottom:function(a){return y.isScrollToBottom(a)},_createMapItems:function(a,f){var g=x.filter(a.results,d.hitch(this,function(a){return"web map"===a.type.toLowerCase()}));if(0!==g.length){var m={},c,n=e("td.empty",f),h;if(0<n.length){var p=g.splice(0,n.length);
for(h=0;h<n.length;h++){var k=n[h];c=this._createMapItem(p[h]);m[c.item.id]=c;b.place(c,k);b.removeClass(k,"empty")}}if(0!==g.length){n=Math.ceil(g.length/5);for(h=0;h<n;h++){c=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");b.place(c,f);p=e("td",c);for(k=0;k<p.length;k++){var l=p[k];(c=g[5*h+k])?(c=this._createMapItem(c),m[c.item.id]=c,b.place(c,l)):b.addClass(l,"empty")}}if(!this.getSelectedMapItem()&&(this.appConfig&&
this.appConfig.map.itemId)&&(c=m[this.appConfig.itemId]))g=e(".map-item-bg",c),b.addClass(g,"selected")}}},_getWebMapCount:function(a){return e(".map-item-div",a).length},_createMapItem:function(a){var f=b.toDom("\x3cdiv class\x3d'map-item-div'\x3e\x3cdiv class\x3d'map-item-bg'\x3e\x3cdiv class\x3d'map-item-thumbnail'\x3e\x3c/div\x3e\x3ca target\x3d'_blank' class\x3d'map-item-detail-icon'\x3e\x3c/a\x3e\x3c/div\x3e\x3cspan class\x3d'map-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),g=e(".map-item-bg",
f)[0],m=e(".map-item-thumbnail",f)[0],c=e(".map-item-title",f)[0];e(".map-item-detail-icon",f)[0].href=a.detailsPageUrl;f.item=a;a.thumbnailUrl?b.setStyle(m,"backgroundImage","url("+a.thumbnailUrl+")"):m.innerHTML=this.nls.noneThumbnail;this.own(l(g,"click",d.hitch(this,this._onMapItemBgClick)));c.innerHTML=a.title;return f},unselect:function(){e(".map-item-bg",this.domNode).removeClass("selected")},_onMapItemBgClick:function(a){a=(a.target||a.srcElement).parentNode;b.hasClass(a,"map-item-bg")&&(this.unselect(),
b.addClass(a,"selected"),this.emit("select",{mapTable:this,selectedNode:a}))},getSelectedMapItem:function(){var a=null,b=e(".map-item-bg.selected",this.domNode);0<b.length&&(a=b[0].parentNode.item);return a}})});