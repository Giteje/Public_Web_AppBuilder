function _getSignInInfo(){var r=[];try{return fs.existsSync(filePath)&&(r=fse.readJsonSync(filePath),r||(r=[])),r}catch(n){return[]}}function _setSignInInfo(r){fs.writeFileSync(filePath,JSON.stringify(r))}function _getCurrentInfo(r){for(var n=0;n<r.length;n++)if(r[n].isCurrent)return r[n];return null}function _getInfoByPortalUrl(r,n){for(var e=0;e<r.length;e++)if(r[e].portalUrl===n)return r[e];return null}function _setInfoByPortalUrl(r,n,e){for(var t=0;t<r.length;t++)r[t].portalUrl===n?(r[t].isCurrent=!0,e.appId&&(r[t].appId=e.appId),e.itemId&&(r[t].itemId=e.itemId)):r[t].isCurrent=!1}var path=require("path"),fs=require("fs"),path=require("path"),fse=require("fs-extra"),logger=require("log4js").getLogger("signininfo"),filePath=path.join(__dirname,"../signininfo.json");exports.getCurentInfoApi=function(r){var n=_getSignInInfo(),e=_getCurrentInfo(n);r(null,e)},exports.getCurentInfo=function(r,n){var e=_getSignInInfo(),t=_getCurrentInfo(e);n.send(null===t?{success:!0,info:{}}:{success:!0,info:t})},exports.getAppId=function(r,n){var e=_getSignInInfo(),t=_getInfoByPortalUrl(e,r.param("portalUrl"));n.send(null===t?{success:!0,appId:null}:{success:!0,appId:t.appId})},exports.setSigninInfo=function(r,n){var e=_getSignInInfo(),t=_getInfoByPortalUrl(e,r.param("portalUrl"));null===t?(e.forEach(function(r){r.isCurrent=!1}),e.push({portalUrl:r.param("portalUrl"),appId:r.param("appId"),supportsOAuth:JSON.parse(r.param("supportsOAuth")),isWebTier:JSON.parse("undefined"==typeof r.param("isWebTier")?!1:!0),isCurrent:!0})):_setInfoByPortalUrl(e,r.param("portalUrl"),{appId:r.param("appId")});try{_setSignInInfo(e),n.send({success:!0})}catch(a){n.send({success:!1,message:"Set appId error."})}};